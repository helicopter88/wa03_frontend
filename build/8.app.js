webpackJsonp([8],{332:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(1),s=l(n),u=a(24),i=a(127),d=(l(i),s["default"].createClass({displayName:"Grid",getInitialState:function(){return{showModal:!1,elements:[],quantity:0,symbol:"",isLoading:!1,ws:new WebSocket("ws://webapps3.westeurope.cloudapp.azure.com:8080/")}},handleSymbol:function(e){this.setState({symbol:e.target.value})},handleValue:function(e){this.setState({quantity:e.target.value})},openModal:function(){this.setState({showModal:!0})},close:function(){this.setState({showModal:!1})},handleMessage:function(e){var t=sessionStorage.userName.length+5;if(e.data.indexOf("ow")>-1){var a=e.data.substring(t),l=JSON.parse(a);this.setState({isLoading:!1,elements:l})}if(e.data.indexOf("exists")>-1&&(e.data.indexOf("true")>-1?this.state.ws.send("yahoo ask_price "+this.state.symbol):alert("No such symbol")),e.data.indexOf("ask_price")>-1){var n=JSON.parse(e.data.substring(10)),s=parseFloat(n.res);this.state.ws.send("db insert_trans "+sessionStorage.userName+" "+this.state.symbol+" "+s+" "+this.state.quantity+" t")}e.data.indexOf("it_"+sessionStorage.userName)>-1&&(e.data.indexOf("false")>-1?(alert("Failed to execute transaction"),this.setState({isLoading:!1})):(this.setState({showModal:!1}),this.state.ws.send("db get_owned "+sessionStorage.userName)))},open:function(){this.state.ws.send("db get_owned "+sessionStorage.userName)},componentWillMount:function(){this.state.ws.addEventListener("open",this.open),this.state.ws.addEventListener("message",this.handleMessage)},buyStocks:function(){var e=(this.state.quantity,this.state.symbol);this.state.ws.send("yahoo exists "+e)},sell:function(e){this.state.ws.send("db insert_trans "+sessionStorage.userName+" "+e.instr+" "+e.bp+" "+this.state.quantity+" f")},render:function(){var e=this,t=this;return s["default"].createElement("div",null,s["default"].createElement("div",{className:"row"},s["default"].createElement("div",{className:"col-lg-12"},s["default"].createElement(u.PageHeader,null,"Portfolio"))),s["default"].createElement("div",{className:"row"},s["default"].createElement("div",{className:"col-lg-12"},s["default"].createElement(u.Panel,null,s["default"].createElement(u.Button,{bsStyle:"warning",onClick:this.openModal},"Buy"),s["default"].createElement("h3",null,"Current holdings"),s["default"].createElement("div",{className:"table-responsive"},s["default"].createElement(u.Table,{striped:!0,bordered:!0,condensed:!0,hover:!0},s["default"].createElement("thead",null,s["default"].createElement("tr",null,s["default"].createElement("th",null,"Instrument"),s["default"].createElement("th",null,"Name"),s["default"].createElement("th",null,"Amount"),s["default"].createElement("th",null,"Bid price"),s["default"].createElement("th",null,"Ask Price"),s["default"].createElement("th",null,"Sell"))),s["default"].createElement("tbody",null,this.state.elements.map(function(a){return s["default"].createElement("tr",null,s["default"].createElement("td",null," ",a.instr," "),s["default"].createElement("td",null,a.name," ")," ",s["default"].createElement("td",null,"  ",a.amount," ")," ",s["default"].createElement("td",null," ",a.bp," ")," ",s["default"].createElement("td",null," ",a.ap," ")," ",s["default"].createElement("td",null,"  ",s["default"].createElement("input",{type:"number",value:e.state.quantity,onChange:e.handleValue}),s["default"].createElement(u.Button,{bsStyle:"danger",bsSize:"small",disabled:e.state.isLoading,onClick:function(){t.setState({isLoading:!0}),t.sell(a)}},t.state.isLoading?"Selling...":"Sell"," ",e.state.quantity," of ",a.instr)))}))))),s["default"].createElement(u.Modal,{show:this.state.showModal,onHide:this.close},s["default"].createElement(u.Modal.Header,{closeButton:!0},s["default"].createElement(u.Modal.Title,null,"Buy more instruments")),s["default"].createElement(u.Modal.Body,null,s["default"].createElement("form",{onSubmit:this.buyStocks},s["default"].createElement("h4",null,"The instrument symbol below:"),s["default"].createElement("input",{type:"search",value:this.state.symbol,onChange:this.handleSymbol,placeholder:"Eg AAPL:"}),s["default"].createElement("br",null),s["default"].createElement("h4",null,"Quantity below:"),s["default"].createElement("input",{type:"number",value:this.state.quantity,onChange:this.handleValue,placeholder:"Quantity:"}),s["default"].createElement("br",null),s["default"].createElement("br",null),s["default"].createElement(u.Button,{bsStyle:"success",onClick:this.state.isLoading?null:this.buyStocks},this.state.isLoading?"Buying... ":"Buy"," ",this.state.quantity," of ",this.state.symbol))),s["default"].createElement(u.Modal.Footer,null,s["default"].createElement(u.Button,{onClick:this.close},"Close"))))))}}));t["default"]=d,e.exports=t["default"]}});